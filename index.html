<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>

        <title>Magic Cube</title>

        <link rel="stylesheet" type="text/css" href="theme.css" />
        
        <script src="math/minMatrix.js" type="text/javascript"></script> 
        <script src="rendering/WebGLRenderer.js" type="text/javascript"></script>
        <script src="rendering/WebGL.js" type="text/javascript"></script>
        <script src="core/CubeMeshDef.js" type="text/javascript"></script> 
        <script src="core/ObjParser.js" type="text/javascript"></script> 
        <script src="core/Cube.js" type="text/javascript"></script> 
        <script src="core/Ray.js" type="text/javascript"></script> 
        <script src="app/MagicCube.js" type="text/javascript"></script>  
        <script src="app/main.js" type="text/javascript"></script> 

        <script id="vshader" type="x-shader/x-vertex">
    		//※顶点着色器
            attribute vec3 position;
            attribute vec4 color;
            attribute vec2 textureCoord;
            uniform   mat4 mMatrix;
            uniform   mat4 mvpMatrix;
            //uniform   sampler2D texture;
            varying   vec4 vColor;
            varying   vec2 vTextureCoord;

            //光效果变量
            attribute vec3 normal;
            uniform   mat4 invMatrix;
            uniform   vec3 lightDirection;
            uniform   vec3 switchs;

            //优化处理项

            void main(void){  
                vec3 li_co = vec3(1.0, 1.0, 1.0);  //光颜色
                vec3 no_di = (mMatrix*vec4(normal,0.0)).xyz; //把顶点旋转应用到法线上
                float diffuse = max(dot(lightDirection,no_di),0.4); //计算法线与光线的点积,光照系数
                vec3  li = diffuse * li_co; //应用光的颜色

                vColor = color * vec4(li, 1.0);

                vTextureCoord = textureCoord;     
                gl_Position   = mvpMatrix * vec4(position, 1.0); 
            } 
		</script>

		<script id="fshader" type="x-shader/x-fragment">
    		//※片段着色器
    		precision mediump float;

            //uniform sampler2D texture;
            varying vec4      vColor;
            varying vec2      vTextureCoord;

            void main(void){
                //vec4 smpColor = texture2D(texture, vTextureCoord);
                gl_FragColor  = vColor;// * smpColor;
            }
		</script>
        <script>

        </script>
    </head>
    <body>  	
        <div class="container" id="gl-canvas">
            <canvas id="canvas">Your Browser doesn't support WebGL.</canvas>
            <canvas id="text"></canvas>
    	</div>
        <div id="gl-text">
        </div>
        <div id="gl-setting">
        </div>
    </body>
</html>
